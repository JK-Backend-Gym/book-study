# Key-Value Store
* í•´ë‹¹ ì €ìž¥ì†Œì— ì €ìž¥ë˜ëŠ” 'Key'ëŠ” ê³ ìœ í•œ ì‹ë³„ìž(identifier)ì´ì–´ì•¼ í•œë‹¤.
  * í•´ë‹¹ KeyëŠ” ìœ ì¼í•´ì•¼ í•˜ë©°, í•´ë‹¹ Keyì— ëŒ€í•œ ValueëŠ” Keyë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼í•  ìˆ˜ ìžˆë‹¤.
  * ì„±ëŠ¥ ìƒ KeyëŠ” ì§§ì„ ìˆ˜ë¡ ì¢‹ë‹¤. (Keyì˜ í¬ê¸°ê°€ ì ì„ìˆ˜ë¡ ì¢‹ë‹¤.)
* Key-Value Storeë¡œ ìžì£¼ ì“°ì´ëŠ” ê²ƒì€ 'Redis' / 'AWS Dynamo DB' / 'memcached'

---

* ì±…ì—ì„œ ë§í•˜ëŠ” ì™„ë²½í•œ ì„¤ê³„ëŠ” ì—†ì§€ë§Œ, 'ì“¸ë§Œí•œ ì„¤ê³„ ë‹µì•ˆ'
> ì½ê¸°, ì“°ê¸°, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì‚¬ì´ì˜ ê· í˜•ì„ ì°¾ê³  ë°ì´í„°ì˜ ì¼ê´€ì„±ê³¼ ê°€ìš©ì„± ì‚¬ì´ì—ì„œ íƒ€í˜‘ì  ê²°ì •ì„ ë‚´ë¦° ì„¤ê³„ 

* ì±…ì˜ K/V Store ì„¤ê³„
> K/V ìŒì˜ í¬ê¸°ëŠ” 10KB (10 * 10^3) ì´í•˜
> í° ë°ì´í„° ì €ìž¥ì„ ê³ ë ¤í•´ì•¼ í•œë‹¤.
> ë†’ì€ ê°€ìš©ì„± ì œê³µ (ìž¥ì•  ì‹œì—ë„ ì„œë¹„ìŠ¤ ì§€ì†)
> ë†’ì€ Scalability ì œê³µ (ë°ì´í„° ì¦ê°€ì— ë”°ë¥¸ ìžë™ ì„œë²„ ì¦ì„¤/ì‚­ì œ)
> ë°ì´í„° ì¼ê´€ì„± ìˆ˜ì¤€ì€ ì¡°ì •ì´ ê°€ëŠ¥í•´ì•¼í•œë‹¤.
> ì‘ë‹µ Latencyê°€ ì§§ì•„ì•¼ í•œë‹¤.

* ì„œë¹„ìŠ¤ë§ˆë‹¤ ë‹¤ë¥´ê² ì§€ë§Œ, ê°œì¸ì ìœ¼ë¡œ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ì§€í‘œëŠ” ê°€ìš©ì„±, Scalability

---
## ë‹¨ì¼ ì„œë²„ K/V Store
* K/V Storeë¥¼ ë‹¨ì¼ ì„œë²„ë¡œ ì‚¬ìš©í•œë‹¤ë©´, ëª¨ë“  K/Vë¥¼ ë©”ëª¨ë¦¬ì— ì €ìž¥í•˜ëŠ”ê²Œ ê°€ìž¥ ì§ê´€ì 
  * ë¹ ë¥¸ ì‘ë‹µì„ ë³´ìž¥í•˜ì§€ë§Œ, ë°ì´í„°ê°€ ë§Žì•„ì§€ë©´ ë©”ëª¨ë¦¬ì— ëª¨ë“  ë°ì´í„°ë¥¼ ë„£ëŠ” ê²ƒì´ íž˜ë“¤ ìˆ˜ ìžˆë‹¤.
* í•´ê²°ì±…ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ 2ê°€ì§€ ì¡´ìž¬
  * ìžì£¼ ì“°ì´ëŠ” ë°ì´í„°ë§Œ ë©”ëª¨ë¦¬ì— ë‘ê³  ë‚˜ë¨¸ì§€ëŠ” ë””ìŠ¤í¬ ì €ìž¥ -> ë””ìŠ¤í¬ëŠ” ë°±ì—…ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ê³  ë©”ëª¨ë¦¬ê°€ ê½‰ì°¨ë©´ ì„œë²„ ì¦ì„¤ ê³ ë ¤í•´ì•¼í• ë“¯?
  * ë°ì´í„° ì••ì¶• 
    * ë°ì´í„° ì••ì¶•ì„ í†µí•´ ë°ì´í„° í¬ê¸°ë¥¼ ì¤„ì—¬ì„œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì¤„ì˜€ì—ˆìŒ

---
## ë¶„ì‚° ì„œë²„ K/V Store
* ì‚¬ìš©ìžì˜ íŠ¸ëž˜í”½ì´ ë§Žì•„ì§€ë©´ WASë¥¼ Scale out í•˜ëŠ” ê²ƒì²˜ëŸ¼, ë°ì´í„° ì–‘ì´ ë§Žì•„ì§€ë©´ K/V Storeë„ Scale Out í•´ì•¼í•œë‹¤.
* Scale Out ì‹œ ê³ ë ¤í•  ì ì€ `CAP(Consistency, Availability, Partition tolerance)`

### CAP
* C : Consistency (ë°ì´í„° ì¼ê´€ì„±)
  * ë¶„ì‚° ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ëŠ” ì–´ëŠ ë…¸ë“œì— ì ‘ê·¼í•˜ë“ ì§€ ë™ì¼í•œ ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìžˆì–´ì•¼ í•œë‹¤.
* A : Availability (ê°€ìš©ì„±)
  * ë¶„ì‚° ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ëŠ” íŠ¹ì • ë…¸ë“œì— ìž¥ì• ê°€ ë°œìƒí•˜ë”ë¼ë„ í•­ìƒ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìžˆì–´ì•¼ í•œë‹¤.
* P : Partition Tolerance (íŒŒí‹°ì…˜ ê´€ìš©?>)
  * CAPì—ì„œ ë§í•˜ëŠ” Partitionì€ ë¶„ì‚° ì‹œìŠ¤í…œ ê°„ì˜ í†µì‹  ìž¥ì• ë¥¼ ì˜ë¯¸í•œë‹¤.
  * ë”°ë¼ì„œ, Partition ToleranceëŠ” ë¶„ì‚° ì‹œìŠ¤í…œ ê°„ì˜ í†µì‹ ì´ ì‹¤íŒ¨í•˜ë”ë¼ë„ ì‹œìŠ¤í…œì€ ê³„ì† ë™ìž‘í•´ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸.

### CAP ì •ë¦¬ (CAP Theorem)
* CAP ì •ë¦¬ëž€, 3ê°€ì§€ ìš”ì†Œ ì¤‘ 2ê°€ì§€ë¥¼ ì¶©ì¡±í•˜ë ¤ë©´ ë‚˜ë¨¸ì§€ 1ê°€ì§€ëŠ” ë°˜ë“œì‹œ í¬ìƒë˜ì–´ì•¼ í•œë‹¤ëŠ” ì´ë¡ ì´ë‹¤.

![img.png](images/seonghun-06-01.png)

* ì¦‰, CAP ì •ë¦¬ì— ì˜í•˜ë©´ ë¶„ì‚° ì‹œìŠ¤í…œì€ ë‹¤ìŒê³¼ ê°™ì€ 3ê°€ì§€ ì‹œìŠ¤í…œìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìžˆë‹¤.
  * CA
  * CP
  * AP

### CA
* CA : Consistency + Availabilityë¡œ, ì‹œìŠ¤í…œ ê°„ í†µì‹  ìž¥ì• ë¡œ ì¸í•œ ìž¥ì• ëŠ” ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤? -> ì‹¤ë¬´ì ìœ¼ë¡œ í•˜ë©´ ì•ˆë˜ëŠ” ì‹œìŠ¤í…œ
  * ì‹œìŠ¤í…œ ê°„ í†µì‹  ìž¥ì• ê°€ ë°œìƒí•˜ë”ë¼ë„ ì‹œìŠ¤í…œì´ ì •ìƒ ë™ìž‘í•˜ë„ë¡ ì„¤ê³„ í•´ì•¼í•œë‹¤! (ì‹¤ì§ˆì ìœ¼ë¡œ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œëŠ” Pë¥¼ í•­ìƒ ì§€ì¼œì•¼ í•œë‹¤!)
  * ðŸ¤” ì²˜ìŒì—ëŠ” í†µì‹  ìž¥ì• ê°€ ë°œìƒí•˜ë”ë¼ë„ ìž¥ì• ë¥¼ ê·¸ëŒ€ë¡œ ì‘ë‹µì— ì „íŒŒí•˜ë©´ Pë¥¼ ì§€í‚¤ì§€ ì•Šê³ ë„ ê´œì°®ì€ ê²ƒ ì•„ë‹Œê°€? í–ˆì—ˆëŠ”ë°
  * Pë¥¼ ì§€í‚¤ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì€ í†µì‹  ìž¥ì• ê°€ ë°œìƒí–ˆì„ ë•Œ í”„ë¡œì„¸ìŠ¤ê°€ ê·¸ëŒ€ë¡œ ì£½ê±°ë‚˜ ë¬´í•œ ëŒ€ê¸°ì— ë¹ ì§€ëŠ” ê²ƒ!
  * ê·¸ëŒ€ë¡œ ìž¥ì• ë¥¼ ì‘ë‹µì— ë³´ë‚´ëŠ” ê²ƒì€ CPìž„!

### Partition ë¬¸ì œ
* ì‹¤ì§ˆì ìœ¼ë¡œ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ Partition Toleranceë¥¼ ì§€ì¼œì•¼ í•œë‹¤.
* ë”°ë¼ì„œ Partition ë¬¸ì œ(ë„¤íŠ¸ì›Œí¬ í†µì‹  ìž¥ì• )ê°€ ë°œìƒí–ˆì„ ë•Œ Availabilityë¥¼ ì§€í‚¬ ê²ƒì¸ì§€, Consistencyë¥¼ ì§€í‚¬ ê²ƒì¸ì§€ì— ë”°ë¼ CP, APë¡œ ë‚˜ë‰œë‹¤.


### CP
* CP : Consistency + Partition Toleranceë¡œ ì‹œìŠ¤í…œ ê°„ í†µì‹  ìž¥ì• ê°€ ë°œìƒí–ˆì„ ë•Œ Availability ëŒ€ì‹  Consistencyë¥¼ ì„ íƒ
  * "í‹€ë¦° ë°ì´í„°ë¥¼ ì¤„ ë°”ì—” ì°¨ë¼ë¦¬ ì‘ë‹µí•˜ì§€ ì•Šê² ë‹¤" 
  * ì‹œìŠ¤í…œ ê°„ í†µì‹  ìž¥ì• ê°€ ë°œìƒí–ˆì„ ë•Œ, ë°ì´í„° ì¼ê´€ì„±ì„ ì¤‘ìš”ì‹œí•˜ì—¬ ê°€ìš©ì„±ì„ í¬ìƒí•˜ì—¬ ìž¥ì• ê°€ ë°œìƒí•œ ì‹œìŠ¤í…œì— ì ‘ê·¼í•œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µí•˜ì§€ ì•ŠëŠ”ë‹¤. (ìž¥ì•  ë°œìƒ)
  * e.g) ê¸ˆìœµ ì‹œìŠ¤í…œ : ì„œë¡œ ë‹¤ë¥¸ ë…¸ë“œ ì ‘ê·¼ ì‹œ ë°ì´í„° ì¼ê´€ì„±ì´ ì§€ì¼œì§€ì§€ ì•Šìœ¼ë©´ Criticalí•˜ë¯€ë¡œ ë³´ì—¬ì£¼ì§€ ì•Šê³  ì•„ì˜ˆ ì—ëŸ¬ë¡œ ì‘ë‹µí•œë‹¤.


### AP
* AP : Availability + Partition Toleranceë¡œ ì‹œìŠ¤í…œ ê°„ í†µì‹  ìž¥ì• ê°€ ë°œìƒí–ˆì„ ë•Œ Consistency ëŒ€ì‹  Availabilityì„ ì„ íƒ
  * "ë°ì´í„°ê°€ í‹€ë ¤ë„ ì¼ë‹¨ ì„œë¹„ìŠ¤í•œë‹¤"
  * ì‹œìŠ¤í…œ ê°„ í†µì‹  ìž¥ì• ê°€ ë°œìƒí–ˆì„ ë•Œ, ê°€ìš©ì„±ì„ ì¤‘ìš”ì‹œí•˜ì—¬ ë°ì´í„° ì¼ê´€ì„±ì„ í¬ìƒí•˜ì—¬ ìž¥ì• ê°€ ë°œìƒí•œ ì‹œìŠ¤í…œì— ì ‘ê·¼í•œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œë„ í‹€ë¦° ë°ì´í„°ë¡œ ì‘ë‹µì„ í•œë‹¤. (ìž¥ì•  ë³µêµ¬ í›„ ë°ì´í„° ë™ê¸°í™” í•„ìš”)
  * e.g) ë°ì´í„° ì¼ê´€ì„±ì´ í‹€ë ¤ë„ Criticalí•˜ì§€ ì•Šì€ ë„ë©”ì¸, ì‹œìŠ¤í…œ 
    * ê³µê³  ë„ë©”ì¸ -> ì‚¬ìš©ìžê°€ ìž‘ì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•œ ê³µê³ ê°€ ë°”ë¡œ ë°˜ì˜ë˜ì§€ ì•Šì•„ë„ Critical í•˜ì§€ ì•Šê³ , ìž¥ì• ê°€ ë°œìƒí•˜ëŠ”ê²Œ ì‚¬ìš©ìžì—ê²Œ ë” ë¶€ì •ì ì¸ ê²½í—˜

---
## ë¶„ì‚° K/V Storeì— ì‚¬ìš©ë˜ëŠ” ì‹œìŠ¤í…œ ì»´í¬ë„ŒíŠ¸

### 1. ë°ì´í„° íŒŒí‹°ì…”ë‹
* ë°ì´í„°ë¥¼ ë¶„ì‚° K/V Storeì— ì €ìž¥í•  ë•Œ ìž‘ì€ íŒŒí‹°ì…˜ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ì„œ ì €ìž¥
* ì´ë•Œ ì¤‘ìš”í•œ ì ì€
  * íŒŒí‹°ì…˜ëœ ë°ì´í„°ë¥¼ ë¶„ì‚° ì‹œìŠ¤í…œì— ê³ ë¥´ê²Œ ë¶„ì‚°ì‹œì¼œì•¼ í•œë‹¤.
  * ë¶„ì‚° ì‹œìŠ¤í…œ ë…¸ë“œê°€ ì¶”ê°€ë˜ê±°ë‚˜ ì‚­ì œë  ë•Œ ë°ì´í„°ì˜ ìž¬ë°°ì¹˜(ì´ë™)ì„ ìµœì†Œí™” í•´ì•¼ í•œë‹¤.
* ì´ë¥¼ ìœ„í•´ Consistent Hashing (ì•ˆì • í•´ì‹œ)ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ íŒŒí‹°ì…”ë‹í•œë‹¤!
  * ê°€ìƒ ë…¸ë“œë¥¼ í†µí•´ ê· ë“±í•œ ë¶„í¬ì— ê°€ê¹ê²Œ ë°°ì¹˜í•  ìˆ˜ ìžˆê³ , ë¶„ì‚° ì‹œìŠ¤í…œ ë…¸ë“œ ì¶”ê°€/ì‚­ì œ ì‹œ ë°ì´í„° ì´ë™ì„ ìµœì†Œí™” í•  ìˆ˜ ìžˆë‹¤.


### 2. ë°ì´í„° ë‹¤ì¤‘í™”
* ë°ì´í„°ë¥¼ ë‹¨ìˆœ íŒŒí‹°ì…”ë‹ë§Œ í•˜ì—¬ 1ê°œì˜ íŠ¹ì • ì„œë²„ì—ë§Œ ì €ìž¥í•  ê²½ìš° í•´ë‹¹ ì„œë²„ ìž¥ì•  ì‹œì— ê°€ìš©ì„±ì„ ë³´ìž¥í•  ìˆ˜ ì—†ë‹¤.
* ë”°ë¼ì„œ, ê° íŒŒí‹°ì…˜ëœ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ëŒ€ì˜ ì„œë²„ì— ë³µì œ(Replication)í•˜ì—¬ ì €ìž¥í•œë‹¤.
* ë°©ë²•ìœ¼ë¡œëŠ” 1ê°œ ì„œë²„ì— ë°ì´í„°ê°€ ì €ìž¥ë  ë•Œ ë¹„ë™ê¸°ë¡œ ì—¬ëŸ¬ ëŒ€ì˜ ë‹¤ë¥¸ ì„œë²„ì— í•´ë‹¹ ë°ì´í„°ë¥¼ ë³µì œí•˜ëŠ” ë°©ë²•!


### 3. ë°ì´í„° ì¼ê´€ì„±
* ë°ì´í„°ê°€ ë‹¤ì¤‘í™” ë˜ì—ˆì„ ë•Œ ì¤‘ìš”í•œ ê²ƒì€ 'ë°ì´í„° ì¼ê´€ì„±'ì´ë‹¤!
  * ë°ì´í„°ë¥¼ ë³µì œí•œ ì„œë²„ë“¤ì— ë°ì´í„°ê°€ ì œëŒ€ë¡œ ë³µì œ(ë™ê¸°í™”)ë˜ì—ˆëŠ”ê°€?
* í•´ë‹¹ ì¼ê´€ì„±ì„ ì§€í‚¤ê¸° ìœ„í•´ `Quorum` ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.
  * **ì“°ê¸° ìž‘ì—… ì‹œ, Nê°œì˜ ë³µì œë³¸ ì¤‘ Wê°œ ì´ìƒì˜ ì„œë²„ì— ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ìž¥ë˜ì–´ì•¼ ì“°ê¸° ìž‘ì—…ì´ ì„±ê³µìœ¼ë¡œ ê°„ì£¼ëœë‹¤.**
  * **ì½ê¸° ìž‘ì—… ì‹œ, Nê°œì˜ ë³µì œë³¸ ì¤‘ Rê°œ ì´ìƒì˜ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì™€ì•¼ í•œë‹¤.**
  * ì´ë•Œ, W + R > N ì´ë©´ ê°•í•œ ì¼ê´€ì„±(Strong Consistency)ì„ ë³´ìž¥í•  ìˆ˜ ìžˆë‹¤.
    * ì¦‰, ì“°ê¸° ìž‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëœ í›„ì— ì½ê¸° ìž‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ í•­ìƒ ìµœì‹  ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìžˆë‹¤.
  * ë°˜ëŒ€ë¡œ W + R â‰¤ N ì´ë©´ ìµœì¢… ì¼ê´€ì„±(Eventual Consistency)ì„ ì œê³µí•œë‹¤.
    * ì¦‰, ì“°ê¸° ìž‘ì—…ì´ ì™„ë£Œëœ í›„ ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ë©´ ëª¨ë“  ë³µì œë³¸ì´ ë™ì¼í•œ ë°ì´í„°ë¥¼ ê°–ê²Œ ëœë‹¤.
![img.png](images/seonghun-06-02.png)

### 4. ì¼ê´€ì„± ëª¨ë¸
* ê°•í•œ ì¼ê´€ì„±(Strong Consistency)
  * ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ê°€ í•­ìƒ ìµœì‹  ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìžˆë‹¤.
  * ì“°ê¸° ìž‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëœ í›„ì— ì½ê¸° ìž‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ í•­ìƒ ìµœì‹  ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìžˆë‹¤.
* ìµœì¢… ì¼ê´€ì„±(Eventual Consistency)
  * ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ë©´ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ê°€ ë™ì¼í•œ ë°ì´í„°ë¥¼ ê°–ê²Œ ëœë‹¤.
  * ì“°ê¸° ìž‘ì—…ì´ ì™„ë£Œëœ í›„ ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ë©´ ëª¨ë“  ë³µì œë³¸ì´ ë™ì¼í•œ ë°ì´í„°ë¥¼ ê°–ê²Œ ëœë‹¤.
* ê°•í•œ ì¼ê´€ì„±ì€ ë°ì´í„° ì¼ê´€ì„±ì„ ë³´ìž¥í•˜ì§€ë§Œ, ì“°ê¸° ìž‘ì—…ì˜ ì§€ì—° ì‹œê°„ì´ ì¦ê°€í•  ìˆ˜ ìžˆë‹¤.
* ìµœì¢… ì¼ê´€ì„±ì€ ì“°ê¸° ìž‘ì—…ì˜ ì§€ì—° ì‹œê°„ì„ ì¤„ì¼ ìˆ˜ ìžˆì§€ë§Œ, ì¼ì‹œì ìœ¼ë¡œ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•  ìˆ˜ ìžˆë‹¤.


### 5. Eventual Consistencyì—ì„œ ì¼ê´€ì„± ë³´ìž¥ ë°©ë²•
* ë™ì‹œì— ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ ë™ì¼í•œ Keyì— ëŒ€í•´ ì“°ê¸° ìž‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ, ë°ì´í„° ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìžˆë‹¤.
* í•´ë‹¹ ë°ì´í„° ì¶©ëŒì„ í•´ê²°í•˜ëŠ” ë°©ë²•ì´ 'ë²„ì €ë‹ê³¼ ë²¡í„° ì‹œê³„(vector clock)'
  * ë²¡í„° ì‹œê³„ë¥¼ ì‚¬ìš©í•˜ì—¬ '[ì„œë²„_ID, ë°ì´í„°_ë²„ì „]'ìœ¼ë¡œ ë°ì´í„° ë²„ì „ì„ ì €ìž¥í•œë‹¤.
  * ì¼ë°˜ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì €ìž¥í•  ë•Œ í•´ë‹¹ ë°ì´í„°ì˜ Metadataë¡œ í•¨ê»˜ ì €ìž¥í•˜ì—¬ I/O ë¹„ìš© ì ˆì•½
  * ë°ì´í„° PUT(ìˆ˜ì •) ì‹œì—ëŠ” ìš°ì„  ì¶©ëŒ íŒë‹¨í•˜ì§€ ì•Šê³  ì¼ë‹¨ ì €ìž¥
  * ë°ì´í„°ë¥¼ GET í•  ë•Œ Metadataì¸ ë²¡í„° ì‹œê³„ì˜ ë°ì´í„° ì¶©ëŒì´ ë°œìƒí•œì§€ íŒë‹¨í•˜ì—¬ ì–´ë–¤ ë°ì´í„°ë¥¼ ì„ íƒí• ì§€ íŒë‹¨í•˜ê³  ì €ìž¥
* ë‹¨ì 
  * ì¶©ëŒ í•´ê²° ë¡œì§ì„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìž‘ì„±í•´ì•¼ í•œë‹¤.
  * ë²¡í„° ì‹œê³„ ë²„ì €ë‹ì¸ '[ì„œë²„_ID, ë°ì´í„° ë²„ì „]'ì˜ ê°œìˆ˜ê°€ ë¹¨ë¦¬ ëŠ˜ì–´ë‚˜ ì„œë²„ ë¶€í•˜ë¥¼ ë§Žì´ ì°¨ì§€í•œë‹¤. -> ì˜¤ëž˜ëœ ë²„ì €ë‹ ì œê±°í•˜ëŠ” ë¡œì§ ì¶”ê°€


### 6. ìž¥ì•  ê°ì§€
* **ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ìž¥ì•  ê°ì§€ëŠ” ì¼ë°˜ì ìœ¼ë¡œ 2ëŒ€ ì´ìƒì˜ ì„œë²„ê°€ íŠ¹ì • ì„œë²„ì˜ ìž¥ì• ë¥¼ ë³´ê³ í•´ì•¼ ìž¥ì• ì¸ ê²ƒìœ¼ë¡œ íŒë‹¨í•œë‹¤.**
* ì´ë¥¼ ìœ„í•´ ê° ë¶„ì‚° ì‹œìŠ¤í…œ ê°„ì˜ ì±„ë„ì„ êµ¬ì„±
  * ë©€í‹°ìºìŠ¤íŒ… ì±„ë„ : í•˜ë‚˜ì˜ ì„œë²„ì—ì„œ ëª¨ë“  ì„œë²„ì—ê²Œ í—¬ìŠ¤ ì²´í¬ ë©”ì‹œì§€ ì „ì†¡ -> ì„œë²„ ìˆ˜ê°€ ëŠ˜ì–´ë‚˜ë©´ í—¬ìŠ¤ì²´í¬ ë©”ì‹œì§€ ì „ì†¡ ë¶€í•˜ ë¶€ë‹´
  * ê°€ì‹­ í”„ë¡œí† ì½œ : í•˜ë‚˜ì˜ ì„œë²„ì—ì„œ íŠ¹ì • Nê°œì˜ ì„œë²„ë¥¼ ê³¨ë¼ì„œ í—¬ìŠ¤ ì²´í¬ ë©”ì‹œì§€ ì „ì†¡


### 7. ì¼ì‹œì  ìž¥ì•  ì²˜ë¦¬
* íŠ¹ì • ì„œë²„ì— ìž¥ì• ê°€ ë°œìƒí–ˆì„ ë•Œ, í•´ë‹¹ ì„œë²„ê°€ ë³µêµ¬ë˜ì—ˆì„ ë•Œ ë°ì´í„° ì¼ê´€ì„±ì„ ë³´ìž¥í•˜ê¸° ìœ„í•´ `hinted handoff` ê¸°ë²•ì„ ì‚¬ìš©í•œë‹¤.
* **ìž¥ì• ê°€ ë°œìƒí•œ íŠ¹ì • ì„œë²„ì˜ ìš”ì²­ë“¤ì„ ë‹¤ë¥¸ ì„œë²„ê°€ ë§¡ì•„ì„œ ì²˜ë¦¬í•˜ê³  ë³€ê²½ ì‚¬í•­ë“¤ì„ 'hint'ë¡œ ê¸°ë¡í•´ë†“ëŠ” ê¸°ë²•ì´ë‹¤.**
* ìž¥ì• ê°€ ë³µêµ¬ë˜ì—ˆì„ ë•Œ, ê¸°ë¡ëœ 'hint'ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³€ê²½ ì‚¬í•­ë“¤ì„ í•´ë‹¹ ì„œë²„ì— ì „ì†¡í•˜ì—¬ ë°ì´í„° ì¼ê´€ì„±ì„ ìœ ì§€í•œë‹¤.


### 8. ì˜êµ¬ ìž¥ì•  ì²˜ë¦¬
* ë¶„ì‚° ì‹œìŠ¤í…œ íŠ¹ì • ë…¸ë“œê°€ ì˜êµ¬ ìž¥ì• ë¡œ íŒë‹¨ëœë‹¤ë©´, í•´ë‹¹ ë…¸ë“œë¥¼ ì œê±°í•˜ê³  ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.
* ì´ ê³¼ì •ì—ì„œ í‚¤ ìž¬í• ë‹¹ì´ ë°œìƒí•  ê²ƒì´ë‹¤!
* ì´ë•Œ, ìƒˆë¡œìš´ ë…¸ë“œì˜ í• ë‹¹ëœ Keyë“¤ì„ ê¸°ì¡´ ë…¸ë“œë“¤ì—ì„œ ë°ì´í„° í•˜ë‚˜ì”© ë¹„êµí•˜ëŠ” ê²ƒì€ ë§¤ìš° ë¹„íš¨ìœ¨ì ì´ë‹¤.
* ë”°ë¼ì„œ, ë°ì´í„°ê°€ ë‹¤ë¥¸ ë¶€ë¶„ì„ ì¼ì¹˜ì‹œí‚¤ëŠ” 'Anti Entropy' ì•Œê³ ë¦¬ì¦˜ì„ í•´ì‹œ íŠ¸ë¦¬ë¼ê³  ë¶ˆë¦¬ëŠ” 'Merkle Tree'ë¥¼ ì‚¬ìš©í•´ì„œ ìƒˆë¡œìš´ ë…¸ë“œì˜ Keyë¥¼ ì±„ìš´ë‹¤.
  * ë¨¸í´ íŠ¸ë¦¬ëŠ” ê° ë…¸ë“œì˜ ê°’ë“¤ì„ Hash Functionì„ ì‚¬ìš©í•œ í•´ì‹œ ê°’ìœ¼ë¡œ ì €ìž¥
  * ë°ì´í„° ë¹„êµ ì‹œ ìƒìœ„ ë…¸ë“œì˜ í•´ì‹œ ê°’ì´ ë‹¤ë¥´ë©´ í•´ë‹¹ ë°ì´í„°ëŠ” ë‹¤ë¥¸ ê²ƒ. ë”°ë¼ì„œ, í•´ì‹œë¡œ ë°ì´í„° ì°¨ì´ë¥¼ íŒë‹¨ 
* e.g) A, B, C ë…¸ë“œ ìš´ì˜ ì¤‘ C ë…¸ë“œ ìž¥ì•  ë°œìƒ -> D ë…¸ë“œ ì¶”ê°€
  * A, B, D ë…¸ë“œì— ê°ê° ìž¬í• ë‹¹ë  Key ë°°ì •
  * A, B ë…¸ë“œì—ì„œ ë³€ê²½ë˜ëŠ” Keyë“¤ì— ëŒ€í•´ì„œë§Œ ë¨¸í´ íŠ¸ë¦¬ ìƒì„±í•˜ê³  Dì˜ ë¹ˆ ë¨¸í´ íŠ¸ë¦¬ì™€ ë¹„êµí•˜ì—¬ ëª¨ë‘ Dì—ê²Œ ë°ì´í„° ë³µì œ

---
## ì‹œìŠ¤í…œ ì•„í‚¤í…ì³ ë‹¤ì´ì–´ê·¸ëž¨
![img.png](images/seonghun-06-03.png)
* í´ë¼ì´ì–¸íŠ¸ API ì œê³µ (Get/Put)
* ë°ì´í„° ë‹¤ì¤‘í™” (ë¹„ë™ê¸° ë³µì œ)
* ë°ì´í„° ì¼ê´€ì„± ë³´ìž¥ 
  * í´ë¼ì´ì–¸íŠ¸ ìž…ìž¥ : Coordinatorë¡œ Quorum ë°©ì‹ ì‚¬ìš©í•˜ì—¬ ë³´ìž¥
  * ìµœì¢…ì  ì¼ê´€ì„± ì‹œìŠ¤í…œ ë°ì´í„°ë¼ë©´, ë²¡í„° ì‹œê³„ ë°©ì‹ ì‚¬ìš©í•˜ì—¬ ì¶©ëŒ í•´ê²°í•˜ì—¬ ìµœì¢…ì  ì¼ê´€ì„± ë³´ìž¥
* Gossip Protocol ê¸°ë°˜ ìž¥ì•  ê°ì§€ / hinted handoffë¡œ ì¼ì‹œ ìž¥ì•  ì²˜ë¦¬ & ë¨¸í´ íŠ¸ë¦¬ë¡œ ì˜êµ¬ ìž¥ì•  ì²˜ë¦¬ (ë…¸ë“œ ì¶”ê°€ ì‹œ í‚¤ ìž¬í• ë‹¹)

---

## ë¶„ì‚° ì‹œìŠ¤í…œì„ ê°€ì§€ëŠ” ì—¬ëŸ¬ K/V Storeì˜ ì‹œìŠ¤í…œ ì•„í‚¤í…ì³?


### 1. Redis
> Redis Cluster is a distributed implementation of Redis with the following goals in order of importance in the design:

> - High performance and linear scalability up to 1000 nodes. **There are no proxies, asynchronous replication is used, and no merge operations are performed on values.**
* 1000ê°œ ë…¸ë“œê¹Œì§€ì˜ ë†’ì€ í™•ìž¥ì„±ê³¼ ë†’ì€ ì„±ëŠ¥ì„ ì œê³µ
* í”„ë¡ì‹œëŠ” ë³„ë„ë¡œ ì—†ì§€ë§Œ ë¹„ë™ê¸° ë³µì œëŠ” ì‚¬ìš©í•˜ê³  ë°ì´í„° ì¶©ëŒì„ í•©ì¹˜ëŠ” merge ì—°ì‚°ì€ ì¡´ìž¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
  * Proxyë¥¼ ë‘ë©´ ë¬¼ë¦¬ì  ì„œë²„ê°€ ëŠ˜ì–´ì„œ hopë„ ì¦ê°€í•˜ê³  ì„±ëŠ¥ ì €í•˜
  * ë°ì´í„° Get/Put ë§ˆë‹¤ Quorum ë°©ì‹ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ. ë°ì´í„° ì¼ê´€ì„±ë³´ë‹¤ ê°€ìš©ì„±ì„ ì¤‘ì‹œí•˜ëŠ” AP ì‹œìŠ¤í…œ?
  * ë°ì´í„° ì¶©ëŒì´ ë°œìƒí•˜ë©´ `Last Write Wins`ìœ¼ë¡œ, ë§ˆì§€ë§‰ì— ì“°ì¸ ë°ì´í„°ë¡œ ë®ì–´ ì“°ê±°ë‚˜ ê³¼ë°˜ìˆ˜ ì§€ì—­(Majority)ì˜ ë°ì´í„°ë¡œ ë®ì–´ ì”€

> - Acceptable degree of write safety: the system tries (in a best-effort way) to retain all the writes originating from clients connected with the majority of the master nodes. Usually there are small windows where acknowledged writes can be lost. Windows to lose acknowledged writes are larger when clients are in a minority partition.
* ëŒ€ë‹¤ìˆ˜ì˜ ë§ˆìŠ¤í„° ë…¸ë“œê°€ ì—°ê²°ëœ êµ¬ì—­? í´ë¼ì´ì–¸íŠ¸ì—ê²ŒëŠ” ëª¨ë“  ì“°ê¸° ìž‘ì—…ì„ ì–»ê¸° ìœ„í•´ ë…¸ë ¥í•œë‹¤.
* ì†Œìˆ˜ì˜ êµ¬ì—­(ë§ˆìŠ¤í„° ë…¸ë“œê°€ ê³¼ë°˜ìˆ˜ ì´í•˜ ì—°ê²°ëœ êµ¬ì—­)ì—ëŠ” í° ë°ì´í„° ìœ ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìžˆë‹¤.


> - Availability: Redis Cluster is able to survive partitions where the majority of the master nodes are reachable and there is at least one reachable replica for every master node that is no longer reachable. Moreover using replicas migration, masters no longer replicated by any replica will receive one from a master which is covered by multiple replicas.



























