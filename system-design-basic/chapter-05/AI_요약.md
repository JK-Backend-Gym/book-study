주요 주제
- 해시 함수의 동작 원리와 문제점
- 균등 분포를 달성하기 위한 기법과 그 한계
- 해시 저장 방식과 성능에 대한 비교와 고려 사항


안정 해시 정의
- 안정 해시 라는 말을 처음 들어봐서 안정이라는 정의가 뭔지 생각하면서 책을 읽었음
- 균등하게 분포가 되면 안정하다고 하는지 서버가 불안정한 상황에도 잘 동작을 한다는 뜻이 안정하다는 건지 의문점을 가지면서 뒤에 내용을 봄
- 일반적인 해시 함수의 동작 원리를 보여주면서 이때 생기는 문제점이 나옴
- 부하 분산이 되는데 서버가 장애가 나거나 추가되면 오버헤드가 생김

균등 분포의 목적
- 해시 함수는 모든 키를 재배치해서 오버헤드가 발생을 하니까 줄여서 서버가 늘어나거나 삭제가 돼도 조금 더 빨리 리밸런싱이 이루어지고 회복을 함
- 균등 분포의 목적 자체를 달성하는 게 더 어려움
- 균등 분포를 달성하기 위해 제한된 기법이 가상 노드 기법임
- 가상 모드는 표본 자체를 버리는 늘려버리면 되지 않을까라는 아이디어에서 나타난 것임

해시딩의 코드 레벨 과정
- 해시딩을 만들기 위한 코드 레벨에서의 과정이 필요함
- 보편적인 균등 분포 함수는 암호화 기능이 세게 들어가 있어서 무거움

안정 해시
- 안정 해시가 영어로는 컨시스턴트 해시인데 이걸 안정 해시라고 부르는 사람들도 있고 일관된 해시라고도 얘기하는 사람들이 있음
- 보통은 컨시스턴트 해싱이라는 말을 가장 많이 쓴다고 함
- 서버가 4개 있다고 해서 1 2 3 4는 아니고 해싱이니까 랜덤임
- 노드 수가 적을수록 가상 로드가 많아야 함
- 좋은 게 서버도 서버별로 성능이 좋고 안 좋고가 있을 수 있음

캐시 샤딩
- 캐시 샤딩 파티션 할 때에는 속도가 중요하니까 md5 무릎 무릎 뭐 뭐 이걸 쓰고 sh256은 인증 서명 토큰 할 때 저희 JWS 토큰 만든다든가 아니면 치맥 서명한다던가 그럴 때 많이 쓰는 것 같음
- 카산드라 같은 경우에는 머머 해시 무음 해시 다이너버 DB 명 캐시는 엔티5를 사용한다고 함
- 안정 해시랑 조금 자주 비교되는 랑데자브 해싱이 또 있다고 함
- 안정 해시 같은 경우에는 분산 노드를 통해서 이걸 조금 어느 정도의 트래픽을 분산하는 거에 초점이 맞춰져 있다고 하면은 랑데자브 해싱은 우선순위를 둘 수 있는 그런 패싱이라고 함

해시 펑션
- 해시를 저장되는 데이터에 해시 펑션을 먹여서 해시를 저장해야 되는 케이스가 있음
- 컬럼 하나로 중복을 제거해서 보여줘야 됐음
- 성능이 너무 느릴 것 같아서 그룹 바이 하면은 되긴 하는데 무한 스크롤이었음

해시 인덱스의 종류
- 해시 인덱스 종류는 컬럼 데이터 자체를 해시로 해서 저장하는 것임
- 비트리는 영역으로 모아놓으니까 성능이 좋은 느낌임

PK 설정
- 통계 테이블 인덱스를 4개로 함
- PK를 오토 인크리먼트 값으로 필드를 하나 더 안 두면 유니크를 식별하는 게 스타트 데이트 엔드 데이트 4개를 묶어야 됨
- PK를 4개로 묶으면 사이즈가 너무 커짐
- 4개 PK를 잡을까 하다가 성격이 리프 노드에 다 PK가 들어가야 되는데 계속 안 좋아지니까 소원 님한테 여쭤봄
- 보통 두 개 이상 이렇게 하는 경우가 많이 없었다고 하심